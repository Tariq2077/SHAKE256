`timescale 1ns/1ps
module Convert_Digest_rev_128_func (
    input  wire [127:0] in_data,   // Lower 128 bits from squeezed output (little-endian)
    output wire [127:0] out_data   // Converted digest in big-endian order
);
    // This function reverses the order of bytes in the 128-bit word.
    function [127:0] reverse128;
        input [127:0] din;
        integer i;
        reg [127:0] dout;
        begin
            dout = 128'd0;
            for (i = 0; i < 16; i = i + 1) begin
                dout[8*i +: 8] = din[8*(15 - i) +: 8];
            end
            reverse128 = dout;
        end
    endfunction

    assign out_data = reverse128(in_data);
endmodule
